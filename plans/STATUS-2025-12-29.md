# Project Status — 2025-12-29

## Scope recap
The recent work focused on the macOS Settings UI overhaul and HID++ mouse settings (DPI, polling rate, onboard profiles), plus diagnostics for readback and better disconnect handling.

## Implemented (from the plan)
- **Settings UI refresh**
  - Rebuilt Settings layout, sections, and styling to match macOS HIG.
  - Replaced nested tabs in Mouse settings with segmented panes.
  - Added shared Settings components (`SettingsLayout`, `SettingsPane`, `SettingsSection`, captions).

- **DPI controls**
  - Added logarithmic DPI slider with tick indicators.
  - DPI values now sourced only from device-reported list or range (no inferred extras).
  - Improved DPI range parsing to handle Logitech range encoding found in logs.

- **Polling rate controls**
  - Parsing uses device-reported report-rate list bitmask.
  - Set path now supports ms-based values with a mask fallback if needed.
  - Error states scoped to the polling tab only.

- **Onboard profiles**
  - Added `Onboard Profiles` enable/disable support (HID++ 0x8100).
  - UI toggle added with status readback and error handling.
  - Auto-disables onboard profiles before applying DPI/polling changes.

- **Diagnostics**
  - Developer tab now includes a readback button to log current DPI, polling rate, and onboard profile state.

- **Disconnect/reconnect handling**
  - Mouse settings now subscribe to device connection changes.
  - UI shows a “Receiver not connected” state on disconnect and reloads automatically on reconnect.

## Known issues / open items
- **Polling rate still not applying on Superlight Pro (per latest logs).**
  - The device returns HID++ error (0x02) on set for some rates. The code now tries ms-based value first and falls back to mask, but acceptance still needs verification.

- **DPI changes reported as not applying (per latest logs).**
  - Range parsing is now improved; need confirmation that set commands are accepted after onboard profiles are disabled.

- **“Publishing changes from within view updates” warnings**
  - Still observed in logs; likely from state changes triggered during SwiftUI update cycles.

## Suggested next steps
1. Validate DPI and polling rate readback using the Developer tab readback button after changes.
2. Capture fresh HID++ logs around setDPI and setReportRate to confirm device response.
3. If Superlight Pro continues to reject changes, implement profile-specific edits (write into onboard profile data instead of host-only changes).

